version: 2

models:
  - name: dim_films
    description: Film dimension table with basic film information
    columns:
      - name: film_key
        description: Surrogate key for film
        tests:
          - unique
          - not_null
      - name: film_title
        description: Film title
        tests:
          - not_null
      - name: release_date
        description: Film release date
        tests:
          - not_null

  - name: fact_film_performance
    description: Film performance fact table combining financial, critical, and awards data
    columns:
      - name: film_key
        description: Foreign key to dim_films
        tests:
          - not_null
          - relationships:
              to: ref('dim_films')
              field: film_key
      - name: box_office_worldwide
        description: Worldwide box office earnings
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 2000000000

  - name: dim_people
    description: People dimension table
    columns:
      - name: person_key
        description: Surrogate key for person
        tests:
          - unique
          - not_null
      - name: person_name
        description: Person's name
        tests:
          - not_null

  - name: rpt_financial_analysis
    description: Financial performance analysis with decade comparisons and market tiers
    columns:
      - name: film_title
        tests:
          - not_null
      - name: market_tier
        tests:
          - accepted_values:
              values: ["Billion Dollar Club", "Blockbuster", "Hit", "Moderate"]

  - name: rpt_critical_analysis
    description: Critical reception analysis with score consistency metrics
    columns:
      - name: film_title
        tests:
          - not_null
      - name: score_consistency
        tests:
          - accepted_values:
              values: ["Consistent", "Moderate Variance", "High Variance"]

  - name: rpt_evolution_analysis
    description: Year-over-year trends and evolution of Pixar films
    columns:
      - name: release_year
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1995
              max_value: 2024

  - name: rpt_genre_performance
    description: Genre-based performance analysis
    columns:
      - name: genre
        tests:
          - not_null
      - name: success_rate_pct
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 100

  - name: rpt_people_analysis
    description: Director and producer performance analysis
    columns:
      - name: director_name
        tests:
          - not_null
      - name: films_directed
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1

  - name: rpt_awards_analysis
    description: Academy Awards analysis with correlation to box office performance
    columns:
      - name: film_title
        tests:
          - not_null
      - name: win_rate_pct
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              max_value: 100
